<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ØªØ·Ø¨ÙŠÙ‚ Ù…ÙˆØ§Ø¹ÙŠØ¯ Ø§Ù†ØªØ®Ø§Ø¨Ø§Øª Ø§Ù„Ø£Ù†Ø¯ÙŠØ© Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ©</title>
  <style>
    :root {
      --primary-color: #004080;
      --secondary-color: #2c5282;
      --success-color: #28a745;
      --warning-color: #ffc107;
      --danger-color: #dc3545;
      --info-color: #17a2b8;
      --light-color: #f8f9fa;
      --dark-color: #343a40;
      --border-color: #dee2e6;
      --shadow: 0 2px 8px rgba(0,0,0,0.1);
      --transition: all 0.3s ease;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: "Tahoma", "Segoe UI", Arial, sans-serif;
      background: #f4f6f9;
      margin: 0;
      padding: 0;
      color: #333;
      line-height: 1.6;
      overflow-x: hidden;
    }

    .container {
      width: 100%;
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 15px;
    }

    header {
      background: var(--primary-color);
      color: white;
      padding: 1rem 0;
      box-shadow: var(--shadow);
      position: sticky;
      top: 0;
      z-index: 1000;
    }

    .header-content {
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 1rem;
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .logo-icon {
      width: 32px;
      height: 32px;
      background: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--primary-color);
      font-weight: bold;
    }

    h1 {
      font-size: 1.5rem;
      margin: 0;
    }

    .tabs {
      display: flex;
      background: white;
      border-bottom: 2px solid var(--border-color);
      margin-bottom: 1.5rem;
      border-radius: 8px 8px 0 0;
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
    }

    .tab {
      padding: 1rem 1.5rem;
      cursor: pointer;
      border: none;
      background: none;
      font-size: 1rem;
      font-weight: 500;
      color: var(--dark-color);
      transition: var(--transition);
      white-space: nowrap;
    }

    .tab:hover {
      background: var(--light-color);
    }

    .tab.active {
      color: var(--primary-color);
      border-bottom: 3px solid var(--primary-color);
      background: var(--light-color);
    }

    .tab-content {
      display: none;
    }

    .tab-content.active {
      display: block;
      animation: fadeIn 0.3s ease;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .controls {
      background: white;
      padding: 1.5rem;
      border-radius: 12px;
      box-shadow: var(--shadow);
      margin-bottom: 1.5rem;
      width: 100%;
      overflow: hidden;
    }

    .control-group {
      display: flex;
      flex-direction: column;
      gap: 1rem;
      margin-bottom: 1rem;
      width: 100%;
    }

    .select-add, .manual-add {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
      width: 100%;
    }

    select, input[type="text"], input[type="date"], input[type="time"] {
      padding: 0.75rem;
      border: 2px solid var(--border-color);
      border-radius: 8px;
      font-size: 1rem;
      width: 100%;
      transition: var(--transition);
      max-width: 100%;
    }

    select:focus, input:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(0, 64, 128, 0.1);
    }

    .buttons-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 0.75rem;
      margin-top: 1rem;
      width: 100%;
    }

    button {
      padding: 0.75rem 1rem;
      font-size: 0.9rem;
      cursor: pointer;
      border: none;
      border-radius: 8px;
      transition: var(--transition);
      font-weight: 500;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
      min-height: 44px;
      width: 100%;
    }

    button:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }

    button.save { background: var(--success-color); color: white; }
    button.edit { background: var(--warning-color); color: black; }
    button.delete { background: var(--danger-color); color: white; }
    button.export { background: var(--primary-color); color: white; }
    button.add { background: var(--info-color); color: white; }
    button.cancel { background: var(--dark-color); color: white; }
    button.remove { background: #e53e3e; color: white; }
    button.backup { background: var(--secondary-color); color: white; }

    button:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }

    .table-container {
      overflow-x: auto;
      background: white;
      border-radius: 12px;
      box-shadow: var(--shadow);
      margin-bottom: 1.5rem;
      width: 100%;
      -webkit-overflow-scrolling: touch;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      min-width: 600px;
    }

    th, td {
      padding: 1rem;
      text-align: center;
      border: 1px solid var(--border-color);
    }

    th {
      background: var(--primary-color);
      color: white;
      font-weight: 600;
      position: sticky;
      top: 0;
    }

    input[type="date"] {
      max-width: 140px;
      text-align: right;
      direction: ltr;
      font-family: inherit;
    }

    input[type="time"] {
      max-width: 120px;
      text-align: center;
      direction: ltr;
    }

    input[type="date"]::-webkit-calendar-picker-indicator {
      filter: invert(0.5);
      cursor: pointer;
    }

    input[type="date"]::-webkit-datetime-edit {
      direction: rtl;
    }

    input[type="date"]::-webkit-datetime-edit-fields-wrapper {
      direction: ltr;
    }

    input[type="date"]::-webkit-datetime-edit-year-field {
      direction: ltr;
    }

    input[type="date"]::-webkit-datetime-edit-month-field {
      direction: ltr;
    }

    input[type="date"]::-webkit-datetime-edit-day-field {
      direction: ltr;
    }

    input[type="date"] {
      text-align: right;
    }

    input[type="checkbox"] {
      width: 20px;
      height: 20px;
    }

    .action-buttons {
      display: flex;
      justify-content: center;
      gap: 0.5rem;
      flex-wrap: nowrap;
    }

    .action-btn {
      width: 40px;
      height: 40px;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: var(--transition);
      border: none;
      font-size: 1.1rem;
    }

    .action-btn:hover {
      transform: scale(1.1);
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    }

    .edit-btn {
      background: var(--warning-color);
      color: white;
    }

    .delete-btn {
      background: var(--danger-color);
      color: white;
    }

    .save-btn {
      background: var(--success-color);
      color: white;
    }

    .cancel-btn {
      background: var(--dark-color);
      color: white;
    }

    .conflicts {
      background: white;
      padding: 1.5rem;
      border-radius: 12px;
      box-shadow: var(--shadow);
      width: 100%;
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
    }

    .backup-section {
      background: white;
      padding: 2rem;
      border-radius: 12px;
      box-shadow: var(--shadow);
      width: 100%;
      overflow: hidden;
    }

    .backup-info {
      background: #e6f7ff;
      padding: 1rem;
      border-radius: 8px;
      border: 1px solid #91d5ff;
      margin-bottom: 1.5rem;
    }

    .backup-stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1rem;
      margin-bottom: 1.5rem;
    }

    .stat-card {
      background: white;
      padding: 1.5rem;
      border-radius: 8px;
      border: 1px solid var(--border-color);
      text-align: center;
    }

    .stat-number {
      font-size: 2rem;
      font-weight: bold;
      color: var(--primary-color);
      margin-bottom: 0.5rem;
    }

    .backup-buttons {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1rem;
    }

    footer {
      background: var(--primary-color);
      color: white;
      padding: 1.5rem 0;
      margin-top: 2rem;
      text-align: center;
      width: 100%;
    }

    .modal {
      display: none;
      position: fixed;
      z-index: 2000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.5);
    }

    .modal-content {
      background-color: white;
      margin: 15% auto;
      padding: 2rem;
      border-radius: 12px;
      width: 90%;
      max-width: 400px;
      text-align: center;
      box-shadow: 0 4px 20px rgba(0,0,0,0.2);
    }

    .modal-buttons {
      display: flex;
      justify-content: center;
      gap: 1rem;
      margin-top: 1.5rem;
    }

    .conflicts-table {
      width: 100%;
      border-collapse: collapse;
      margin: 1rem 0;
      background: white;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      border-radius: 8px;
      overflow: hidden;
    }

    .conflicts-table th {
      background: var(--secondary-color);
      color: white;
      padding: 1rem;
      text-align: center;
      font-weight: 600;
    }

    .conflicts-table td {
      padding: 0.75rem;
      text-align: center;
      border-bottom: 1px solid var(--border-color);
    }

    .conflicts-table tr:last-child td {
      border-bottom: none;
    }

    .conflicts-table tr:nth-child(even) {
      background-color: #f8fafc;
    }

    .conflict-type {
      font-weight: bold;
      padding: 0.25rem 0.5rem;
      border-radius: 4px;
    }

    .conflict-type-election {
      background: #e6fffa;
      color: #234e52;
    }

    .conflict-type-payment {
      background: #fffaf0;
      color: #744210;
    }

    .conflict-type-mixed {
      background: #e6f7ff;
      color: #004080;
    }

    .conflict-days {
      color: var(--danger-color);
      font-weight: bold;
      background: #fff5f5;
      padding: 0.25rem 0.5rem;
      border-radius: 4px;
    }

    .conflict-clubs {
      font-weight: 500;
      color: var(--dark-color);
    }

    .conflict-dates {
      color: var(--primary-color);
      font-size: 0.9rem;
    }

    .conflict-icon {
      font-size: 1.2rem;
      margin-left: 0.5rem;
    }

    .no-conflicts {
      text-align: center;
      padding: 2rem;
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      color: var(--dark-color);
    }

    .conflicts h2 {
      margin-bottom: 1.5rem;
      color: var(--primary-color);
      border-bottom: 2px solid var(--primary-color);
      padding-bottom: 0.5rem;
    }

    .conflict-note {
      margin-top: 1rem;
      padding: 1rem;
      background: #f8f9fa;
      border-radius: 8px;
      border-right: 4px solid var(--info-color);
      font-size: 0.9rem;
    }

    .auto-calculation-info {
      background: #e6f7ff;
      padding: 1rem;
      border-radius: 8px;
      border: 1px solid #91d5ff;
      margin-top: 1rem;
      font-size: 0.9rem;
    }

    .toggle-container {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      margin-bottom: 1rem;
      background: white;
      padding: 0.75rem;
      border-radius: 8px;
      box-shadow: var(--shadow);
    }

    .time-inputs {
      display: flex;
      gap: 0.5rem;
      align-items: center;
    }

    .time-inputs span {
      font-weight: bold;
      color: var(--dark-color);
    }

    @media (min-width: 768px) {
      h1 {
        font-size: 2rem;
      }
      .control-group {
        flex-direction: row;
        align-items: end;
      }
      .select-add, .manual-add {
        flex: 1;
      }
      .buttons-grid {
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      }
    }

    @media (max-width: 767px) {
      .header-content {
        flex-direction: column;
        text-align: center;
        gap: 1rem;
      }
      
      .tabs {
        flex-wrap: nowrap;
        overflow-x: auto;
      }
      
      .tab {
        padding: 0.75rem 1rem;
        font-size: 0.9rem;
        white-space: nowrap;
      }
      
      th, td {
        padding: 0.5rem;
        font-size: 0.9rem;
      }
      
      input[type="date"] {
        max-width: 120px;
        font-size: 0.8rem;
      }
      
      input[type="time"] {
        max-width: 100px;
        font-size: 0.8rem;
      }
      
      .action-btn {
        width: 35px;
        height: 35px;
        font-size: 1rem;
      }
      
      .modal-content {
        margin: 30% auto;
        padding: 1.5rem;
      }
      
      .backup-stats {
        grid-template-columns: 1fr;
      }
      
      .table-container::-webkit-scrollbar {
        height: 6px;
      }
      
      .table-container::-webkit-scrollbar-thumb {
        background: var(--primary-color);
        border-radius: 3px;
      }
      
      .conflicts::-webkit-scrollbar {
        height: 6px;
      }
      
      .conflicts::-webkit-scrollbar-thumb {
        background: var(--primary-color);
        border-radius: 3px;
      }
    }

    html, body {
      overflow-x: hidden;
      width: 100%;
    }

    .table-container, .conflicts {
      -webkit-overflow-scrolling: touch;
      scrollbar-width: thin;
      scrollbar-color: var(--primary-color) var(--light-color);
    }
  </style>
</head>
<body>
  <header>
    <div class="container">
      <div class="header-content">
        <div class="logo">
          <div class="logo-icon">âš½</div>
          <h1>ØªØ·Ø¨ÙŠÙ‚ Ù…ÙˆØ§Ø¹ÙŠØ¯ Ø§Ù†ØªØ®Ø§Ø¨Ø§Øª Ø§Ù„Ø£Ù†Ø¯ÙŠØ© Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ©</h1>
        </div>
      </div>
    </div>
  </header>

  <main class="container">
    <div class="tabs">
      <button class="tab active" data-tab="main-tab">ğŸ  Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
      <button class="tab" data-tab="backup-tab">ğŸ’¾ ØµÙØ­Ø© Ø§Ù„Ù†Ø³Ø® Ø§Ø­ØªÙŠØ§Ø·ÙŠ</button>
    </div>

    <div id="main-tab" class="tab-content active">
      <section class="controls">
        <div class="control-group">
          <div class="select-add">
            <label for="clubSelect">Ø§Ø®ØªØ± Ù†Ø§Ø¯ÙŠ Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©:</label>
            <select id="clubSelect">
              <option value="">-- Ø§Ø®ØªØ± Ù†Ø§Ø¯ÙŠ --</option>
              <option>Ù†Ø§Ø¯ÙŠ Ø¬Ø±Ø´ Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠ</option>
              <option>Ù†Ø§Ø¯ÙŠ Ø§Ù„Ø£Ù‚ØµÙ‰ Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠ</option>
              <option>Ù†Ø§Ø¯ÙŠ ÙƒÙØ±Ø®Ù„ Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠ</option>
              <option>Ù†Ø§Ø¯ÙŠ Ø³Ø§ÙƒØ¨ Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠ</option>
              <option>Ù†Ø§Ø¯ÙŠ Ø§Ù„ÙƒØªÙ‡ Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠ</option>
              <option>Ù†Ø§Ø¯ÙŠ Ù‚ÙÙ‚ÙØ§ Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠ</option>
              <option>Ù†Ø§Ø¯ÙŠ Ù…Ø±ØµØ¹ Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠ</option>
              <option>Ù†Ø§Ø¯ÙŠ Ø´Ø¨Ø§Ø¨ Ø±ÙŠÙ…ÙˆÙ† Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠ</option>
              <option>Ù†Ø§Ø¯ÙŠ Ø´Ø¨Ø§Ø¨ Ø§Ù„ÙÙŠØ­Ø§Ø¡ Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠ</option>
              <option>Ù†Ø§Ø¯ÙŠ ØºØ²Ø© Ù‡Ø§Ø´Ù… Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠ</option>
              <option>Ù†Ø§Ø¯ÙŠ Ø§ØªØ­Ø§Ø¯ Ø¬Ø±Ø´ Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠ</option>
              <option>Ù†Ø§Ø¯ÙŠ Ø´Ø¨Ø§Ø¨ Ù…Ø±ØµØ¹ Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠ</option>
              <option>Ù†Ø§Ø¯ÙŠ Ù†Ø­Ù„Ø© Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠ</option>
              <option>Ù†Ø§Ø¯ÙŠ Ø¬Ø¨Ø© Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠ</option>
              <option>Ù†Ø§Ø¯ÙŠ Ø´Ø¨Ø§Ø¨ Ø¬Ø¨Ù‡ Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠ</option>
              <option>Ù†Ø§Ø¯ÙŠ Ø´Ø¨Ø§Ø¨ Ø§Ù„Ù…ØµØ·Ø¨Ø© Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠ</option>
              <option>Ù†Ø§Ø¯ÙŠ Ø´Ø¨Ø§Ø¨ Ø³ÙˆÙ Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠ</option>
              <option>Ù†Ø§Ø¯ÙŠ Ø§Ù„Ø±Ø´Ø§ÙŠØ¯Ø© Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠ</option>
            </select>
          </div>
          
          <div class="manual-add">
            <label for="newClubName">Ø¥Ø¶Ø§ÙØ© Ù†Ø§Ø¯ÙŠ Ø¬Ø¯ÙŠØ¯:</label>
            <input type="text" id="newClubName" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù†Ø§Ø¯ÙŠ Ø§Ù„Ø¬Ø¯ÙŠØ¯">
          </div>
        </div>

        <div class="buttons-grid">
          <button class="add" id="addFromSelectBtn">
            <span>â•</span>
            Ø¥Ø¶Ø§ÙØ© Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
          </button>
          <button id="addNewClubBtn">
            <span>â­</span>
            Ø¥Ø¶Ø§ÙØ© Ù†Ø§Ø¯ÙŠ Ø¬Ø¯ÙŠØ¯
          </button>
          <button class="remove" id="deleteFromDropdownBtn">
            <span>ğŸ—‘ï¸</span>
            Ø­Ø°Ù Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
          </button>
          <button class="export" id="exportExcelBtn">
            <span>ğŸ“Š</span>
            ØªØµØ¯ÙŠØ± Ù…Ù„Ù Excel
          </button>
        </div>
      </section>

      <div class="toggle-container">
        <input type="checkbox" id="showElection2" checked>
        <label for="showElection2">Ø¥Ø¸Ù‡Ø§Ø± ÙˆØ¥Ø®ÙØ§Ø¡ Ù…ÙˆØ¹Ø¯ Ø§Ù„Ø§Ù†ØªØ®Ø§Ø¨Ø§Øª Ø§Ù„Ø«Ø§Ù†ÙŠ</label>
      </div>

      <section class="table-container">
        <table id="clubsTable">
          <thead>
            <tr>
              <th>Ø§Ø³Ù… Ø§Ù„Ù†Ø§Ø¯ÙŠ</th>
              <th>Ù…ÙˆØ¹Ø¯ Ø§Ù„Ø§Ù†ØªØ®Ø§Ø¨Ø§Øª Ø§Ù„Ø£ÙˆÙ„</th>
              <th id="election2Header">Ù…ÙˆØ¹Ø¯ Ø§Ù„Ø§Ù†ØªØ®Ø§Ø¨Ø§Øª Ø§Ù„Ø«Ø§Ù†ÙŠ</th>
              <th>Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„ØªØ³Ø¯ÙŠØ¯</th>
              <th>Ù†Ù‡Ø§ÙŠØ© Ø§Ù„ØªØ³Ø¯ÙŠØ¯</th>
              <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </section>

      <section class="conflicts">
        <h2>Ø§Ù„ØªØ¹Ø§Ø±Ø¶Ø§Øª Ø§Ù„Ù…ÙƒØªØ´ÙØ©</h2>
        <div id="conflictsContainer"></div>
      </section>
    </div>

    <div id="backup-tab" class="tab-content">
      <section class="backup-section">
        <h2>ğŸ’¾ Ù†Ø¸Ø§Ù… Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ</h2>
        
        <div class="backup-info">
          <p>ÙŠÙ…ÙƒÙ†Ùƒ Ø­ÙØ¸ ÙˆØ§Ø³ØªØ¹Ø§Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ù„Ø¶Ù…Ø§Ù† Ø¹Ø¯Ù… ÙÙ‚Ø¯Ø§Ù†Ù‡Ø§ Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø¬Ù‡Ø§Ø²</p>
        </div>

        <div class="backup-stats">
          <div class="stat-card">
            <div class="stat-number" id="clubsCount">0</div>
            <div>Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ù†Ø¯ÙŠØ©</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="lastBackup">-</div>
            <div>Ø¢Ø®Ø± Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="dataSize">0 KB</div>
            <div>Ø­Ø¬Ù… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</div>
          </div>
        </div>

        <div class="backup-buttons">
          <button class="backup" id="exportBackupBtn">
            <span>ğŸ“¤</span>
            ØªØµØ¯ÙŠØ± Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©
          </button>
          <button class="add" id="importBackupBtn">
            <span>ğŸ“¥</span>
            Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©
          </button>
          <button class="export" id="exportExcelBtn2">
            <span>ğŸ“Š</span>
            ØªØµØ¯ÙŠØ± Ø¥Ù„Ù‰ Excel
          </button>
          <button class="delete" id="clearAllDataBtn">
            <span>ğŸ—‘ï¸</span>
            Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
          </button>
        </div>

        <div class="backup-info" style="margin-top: 2rem;">
          <h4>ğŸ“‹ ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…:</h4>
          <ul style="text-align: right; margin-right: 1rem;">
            <li>Ø§Ø­ÙØ¸ Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ù‚Ø¨Ù„ ØªØºÙŠÙŠØ± Ø§Ù„Ø¬Ù‡Ø§Ø²</li>
            <li>Ø§Ø³ØªÙˆØ±Ø¯ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ø¹Ù„Ù‰ Ø§Ù„Ø¬Ù‡Ø§Ø² Ø§Ù„Ø¬Ø¯ÙŠØ¯</li>
            <li>Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­ÙÙˆØ¸Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ ÙÙŠ Ù…ØªØµÙØ­Ùƒ</li>
            <li>Ø§Ø³ØªØ®Ø¯Ù… Excel Ù„Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</li>
          </ul>
        </div>
      </section>
    </div>
  </main>

  <div id="confirmationModal" class="modal">
    <div class="modal-content">
      <h3 id="modalTitle">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø°Ù</h3>
      <p id="modalMessage">Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù†Ùƒ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù†Ø§Ø¯ÙŠ?</p>
      <div class="modal-buttons">
        <button class="cancel" id="cancelModalBtn">Ø¥Ù„ØºØ§Ø¡</button>
        <button class="delete" id="confirmModalBtn">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø°Ù</button>
      </div>
    </div>
  </div>

  <footer>
    <div class="container">
      <p>| Â©  ØªØ·Ø¨ÙŠÙ‚ Ù…ÙˆØ§Ø¹ÙŠØ¯ Ø§Ù†ØªØ®Ø§Ø¨Ø§Øª Ø§Ù„Ø£Ù†Ø¯ÙŠØ© 2025| </p>
         <p> Designed by Khaled Almoghrabi</p>
          <p> Ù…Ø¯ÙŠØ±ÙŠØ© Ø´Ø¨Ø§Ø¨ Ù…Ø­Ø§ÙØ¸Ø© Ø¬Ø±Ø´</p>
    </div>
  </footer>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script>
    // Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©
    let clubsData = JSON.parse(localStorage.getItem('electionClubs')) || [];
    let currentEditId = null;
    let modalCallback = null;
    let selectedClubForDeletion = null;
    let showElection2 = true;

    // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
    document.addEventListener('DOMContentLoaded', function() {
      initializeEventListeners();
      loadClubsData();
      renderClubsTable();
      updateBackupStats();
      detectConflicts();
      
      // ØªÙ‡ÙŠØ¦Ø© Ø­Ø§Ù„Ø© Ø®ÙŠØ§Ø± Ø¥Ø¸Ù‡Ø§Ø± Ù…ÙˆØ¹Ø¯ Ø§Ù„Ø§Ù†ØªØ®Ø§Ø¨Ø§Øª Ø§Ù„Ø«Ø§Ù†ÙŠ
      const showElection2Checkbox = document.getElementById('showElection2');
      showElection2Checkbox.checked = showElection2;
      toggleElection2Visibility();
    });

    // ØªÙ‡ÙŠØ¦Ø©  Ø§Ù„Ø£Ø­Ø¯Ø§Ø«
    function initializeEventListeners() {
      // Ø¹Ù„Ø§Ù…Ø§Øª Ø§Ù„ØªØ¨ÙˆÙŠØ¨
      document.querySelectorAll('.tab').forEach(tab => {
        tab.addEventListener('click', () => switchTab(tab.dataset.tab));
      });

      // Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
      document.getElementById('addFromSelectBtn').addEventListener('click', addClubFromSelect);
      document.getElementById('addNewClubBtn').addEventListener('click', addNewClub);
      document.getElementById('deleteFromDropdownBtn').addEventListener('click', deleteFromDropdown);
      document.getElementById('exportExcelBtn').addEventListener('click', exportExcel);
      document.getElementById('exportExcelBtn2').addEventListener('click', exportExcel);

      // Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù†Ø³Ø® Ø§Ø­ØªÙŠØ§Ø·ÙŠ
      document.getElementById('exportBackupBtn').addEventListener('click', exportBackup);
      document.getElementById('importBackupBtn').addEventListener('click', importBackup);
      document.getElementById('clearAllDataBtn').addEventListener('click', clearAllData);

      // Ù†Ø§ÙØ°Ø© Ø§Ù„ØªØ£ÙƒÙŠØ¯
      document.getElementById('cancelModalBtn').addEventListener('click', () => closeModal(false));
      document.getElementById('confirmModalBtn').addEventListener('click', () => closeModal(true));

      // Ø®ÙŠØ§Ø± Ø¥Ø¸Ù‡Ø§Ø±/Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø§Ù†ØªØ®Ø§Ø¨Ø§Øª Ø§Ù„Ø«Ø§Ù†ÙŠØ©
      document.getElementById('showElection2').addEventListener('change', function() {
        showElection2 = this.checked;
        toggleElection2Visibility();
      });

      // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø®Ø§Ø±Ø¬Ù‡Ø§
      window.addEventListener('click', function(event) {
        const modal = document.getElementById('confirmationModal');
        if (event.target === modal) {
          closeModal(false);
        }
      });

      // Ø§Ø³ØªØ®Ø¯Ø§Ù… event delegation Ù„Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ©
      document.getElementById('clubsTable').addEventListener('click', function(e) {
        const target = e.target;
        const button = target.closest('button');
        
        if (!button) return;
        
        const id = button.dataset.id ? parseInt(button.dataset.id) : null;
        
        if (button.classList.contains('edit-btn')) {
          editClub(id);
        } else if (button.classList.contains('delete-btn')) {
          deleteClub(id);
        } else if (button.classList.contains('save-btn')) {
          saveClub(id);
        } else if (button.classList.contains('cancel-btn')) {
          cancelEdit(id);
        }
      });
    }

    // ØªØ­ÙˆÙŠÙ„ Ø¨ÙŠÙ† Ø§Ù„ØªÙˆØ§Ø±ÙŠØ® ÙˆØ§Ù„Ù†ØµÙˆØµ
    function formatDate(dateString) {
      if (!dateString) return '';
      const date = new Date(dateString);
      return date.toLocaleDateString('ar-EG');
    }

    // ØªØ­ÙˆÙŠÙ„ Ø§Ù„ÙˆÙ‚Øª Ø¥Ù„Ù‰ ØµÙŠØºØ© 12 Ø³Ø§Ø¹Ø©
    function formatTimeTo12H(timeString) {
      if (!timeString) return '';
      
      const [hours, minutes] = timeString.split(':');
      const h = parseInt(hours);
      const ampm = h >= 12 ? 'Ù…' : 'Øµ';
      const formattedHours = h % 12 || 12;
      
      return `${formattedHours}:${minutes} ${ampm}`;
    }

    // Ø¥Ø¶Ø§ÙØ© Ø£ÙŠØ§Ù… Ø¥Ù„Ù‰ ØªØ§Ø±ÙŠØ®
    function addDays(date, days) {
      const result = new Date(date);
      result.setDate(result.getDate() + days);
      return result;
    }

    // ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ØªØ§Ø±ÙŠØ® Ø¥Ù„Ù‰ ØµÙŠØºØ© YYYY-MM-DD
    function formatDateForInput(date) {
      if (!date) return '';
      const year = date.getFullYear();
      const month = String(date.getMonth() + 1).padStart(2, '0');
      const day = String(date.getDate()).padStart(2, '0');
      return `${year}-${month}-${day}`;
    }

    // Ø­Ø³Ø§Ø¨ Ø§Ù„ÙØ±Ù‚ Ø¨ÙŠÙ† ØªØ§Ø±ÙŠØ®ÙŠÙ† Ø¨Ø§Ù„Ø£ÙŠØ§Ù…
    function daysBetween(date1, date2) {
      const oneDay = 24 * 60 * 60 * 1000;
      const firstDate = new Date(date1);
      const secondDate = new Date(date2);
      return Math.round(Math.abs((firstDate - secondDate) / oneDay));
    }

    // Ø­Ø³Ø§Ø¨ Ø£ÙŠØ§Ù… Ø§Ù„ØªØ¯Ø§Ø®Ù„ Ø¨ÙŠÙ† ÙØªØ±ØªÙŠÙ†
    function calculateOverlapDays(start1, end1, start2, end2) {
      if (!start1 || !end1 || !start2 || !end2) return 0;
      
      const startDate1 = new Date(start1);
      const endDate1 = new Date(end1);
      const startDate2 = new Date(start2);
      const endDate2 = new Date(end2);
      
      if (startDate1 > endDate1 || startDate2 > endDate2) return 0;
      
      const latestStart = new Date(Math.max(startDate1.getTime(), startDate2.getTime()));
      const earliestEnd = new Date(Math.min(endDate1.getTime(), endDate2.getTime()));
      
      const overlapTime = earliestEnd.getTime() - latestStart.getTime();
      if (overlapTime <= 0) return 0;
      
      return Math.ceil(overlapTime / (1000 * 60 * 60 * 24));
    }

    // Ø­Ø³Ø§Ø¨ Ø§Ù„ØªÙˆØ§Ø±ÙŠØ® ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ ØªØ§Ø±ÙŠØ® Ù…ÙˆØ¹Ø¯ Ø§Ù„Ø§Ù†ØªØ®Ø§Ø¨Ø§Øª Ø§Ù„Ø£ÙˆÙ„
    function calculateDatesAutomatically(election1Date) {
      if (!election1Date) return {};
      
      const election1 = new Date(election1Date);
      
      // Ù…ÙˆØ¹Ø¯ Ø§Ù„Ø§Ù†ØªØ®Ø§Ø¨Ø§Øª Ø§Ù„Ø«Ø§Ù†ÙŠ Ø¨Ø¹Ø¯ 14 ÙŠÙˆÙ…
      const election2 = addDays(election1, 14);
      
      return {
        election2: formatDateForInput(election2)
      };
    }

    // Ø­Ø³Ø§Ø¨ Ù†Ù‡Ø§ÙŠØ© Ø§Ù„ØªØ³Ø¯ÙŠØ¯ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„ØªØ³Ø¯ÙŠØ¯ (10 Ø£ÙŠØ§Ù…)
    function calculatePaymentEnd(paymentStartDate) {
      if (!paymentStartDate) return '';
      
      const paymentStart = new Date(paymentStartDate);
      
      // Ù†Ù‡Ø§ÙŠØ© Ø§Ù„ØªØ³Ø¯ÙŠØ¯ Ø¨Ø¹Ø¯ 9 Ø£ÙŠØ§Ù… Ù…Ù† Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© (Ù„ÙŠØµØ¨Ø­ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ 10 Ø£ÙŠØ§Ù…)
      const paymentEnd = addDays(paymentStart, 9);
      
      return formatDateForInput(paymentEnd);
    }

    // Ø¥Ø¸Ù‡Ø§Ø±/Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø§Ù†ØªØ®Ø§Ø¨Ø§Øª Ø§Ù„Ø«Ø§Ù†ÙŠØ©
    function toggleElection2Visibility() {
      const election2Header = document.getElementById('election2Header');
      const election2Cells = document.querySelectorAll('.election2-cell');
      
      if (showElection2) {
        election2Header.style.display = 'table-cell';
        election2Cells.forEach(cell => cell.style.display = 'table-cell');
      } else {
        election2Header.style.display = 'none';
        election2Cells.forEach(cell => cell.style.display = 'none');
      }
    }

    // Ø¥Ø¯Ø§Ø±Ø© Ø¹Ù„Ø§Ù…Ø§Øª Ø§Ù„ØªØ¨ÙˆÙŠØ¨
    function switchTab(tabId) {
      document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
      document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
      
      document.getElementById(tabId).classList.add('active');
      document.querySelector(`.tab[data-tab="${tabId}"]`).classList.add('active');
      
      if (tabId === 'main-tab') {
        renderClubsTable();
        detectConflicts();
      } else if (tabId === 'backup-tab') {
        updateBackupStats();
      }
    }

    // Ø¥Ø¶Ø§ÙØ© Ù†Ø§Ø¯ÙŠ Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†Ø³Ø¯Ù„Ø©
    function addClubFromSelect() {
      const clubSelect = document.getElementById('clubSelect');
      const selectedClub = clubSelect.value;
      
      if (!selectedClub) {
        alert('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù†Ø§Ø¯ÙŠ Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©');
        return;
      }
      
      if (clubsData.some(club => club.name === selectedClub)) {
        alert('Ù‡Ø°Ø§ Ø§Ù„Ù†Ø§Ø¯ÙŠ Ù…Ø¶Ø§Ù Ù…Ø³Ø¨Ù‚Ø§Ù‹');
        return;
      }
      
      const newClub = {
        id: Date.now(),
        name: selectedClub,
        election1: '',
        election1Time: '09:00',
        election2: '',
        election2Time: '09:00',
        paymentStart: '',
        paymentStartTime: '08:00',
        paymentEnd: '',
        paymentEndTime: '16:00'
      };
      
      clubsData.push(newClub);
      saveClubsData();
      renderClubsTable();
      detectConflicts();
      
      clubSelect.value = '';
    }

    // Ø¥Ø¶Ø§ÙØ© Ù†Ø§Ø¯ÙŠ Ø¬Ø¯ÙŠØ¯ ÙŠØ¯ÙˆÙŠØ§Ù‹
    function addNewClub() {
      const newClubNameInput = document.getElementById('newClubName');
      const newClubName = newClubNameInput.value.trim();
      
      if (!newClubName) {
        alert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ù†Ø§Ø¯ÙŠ');
        return;
      }
      
      if (clubsData.some(club => club.name === newClubName)) {
        alert('Ù‡Ø°Ø§ Ø§Ù„Ù†Ø§Ø¯ÙŠ Ù…Ø¶Ø§Ù Ù…Ø³Ø¨Ù‚Ø§Ù‹');
        newClubNameInput.value = '';
        return;
      }
      
      const newClub = {
        id: Date.now(),
        name: newClubName,
        election1: '',
        election1Time: '09:00',
        election2: '',
        election2Time: '09:00',
        paymentStart: '',
        paymentStartTime: '08:00',
        paymentEnd: '',
        paymentEndTime: '16:00'
      };
      
      clubsData.push(newClub);
      saveClubsData();
      renderClubsTable();
      detectConflicts();
      
      const clubSelect = document.getElementById('clubSelect');
      const option = document.createElement('option');
      option.value = newClubName;
      option.textContent = newClubName;
      clubSelect.appendChild(option);
      
      newClubNameInput.value = '';
    }

    // Ø­Ø°Ù Ù†Ø§Ø¯ÙŠ Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†Ø³Ø¯Ù„Ø©
    function deleteFromDropdown() {
      const clubSelect = document.getElementById('clubSelect');
      const selectedClub = clubSelect.value;
      
      if (!selectedClub) {
        alert('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù†Ø§Ø¯ÙŠ Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©');
        return;
      }
      
      selectedClubForDeletion = selectedClub;
      showModal('Ø­Ø°Ù Ù†Ø§Ø¯ÙŠ', `Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù†Ùƒ ØªØ±ÙŠØ¯ Ø­Ø°Ù "${selectedClub}" Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©ØŸ`, function(confirmed) {
        if (confirmed) {
          // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù†Ø§Ø¯ÙŠ Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†Ø³Ø¯Ù„Ø© ÙÙ‚Ø·
          for (let i = 0; i < clubSelect.options.length; i++) {
            if (clubSelect.options[i].value === selectedClubForDeletion) {
              clubSelect.remove(i);
              break;
            }
          }
          
          clubSelect.value = '';
          selectedClubForDeletion = null;
        }
      });
    }

    // Ø¹Ø±Ø¶ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„Ù„Ø£Ù†Ø¯ÙŠØ©
    function renderClubsTable() {
      const tableBody = document.querySelector('#clubsTable tbody');
      tableBody.innerHTML = '';
      
      if (clubsData.length === 0) {
        const emptyRow = document.createElement('tr');
        emptyRow.innerHTML = `<td colspan="6" style="text-align: center; padding: 20px;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ù†Ø¯ÙŠØ© Ù…Ø¶Ø§ÙØ© Ø¨Ø¹Ø¯</td>`;
        tableBody.appendChild(emptyRow);
        return;
      }
      
      clubsData.forEach(club => {
        const row = document.createElement('tr');
        
        if (club.id === currentEditId) {
          // ÙˆØ¶Ø¹ Ø§Ù„ØªØ­Ø±ÙŠØ±
          row.innerHTML = `
            <td>${club.name}</td>
            <td>
              <input type="date" id="edit-election1-${club.id}" value="${club.election1 || ''}" 
                     onchange="updateCalculatedDates(${club.id})">
              <div class="time-inputs">
                <span>Ø§Ù„Ø³Ø§Ø¹Ø©:</span>
                <input type="time" id="edit-election1Time-${club.id}" value="${club.election1Time || '09:00'}">
              </div>
            </td>
            <td class="election2-cell">
              <input type="date" id="edit-election2-${club.id}" value="${club.election2 || ''}">
              <div class="time-inputs">
                <span>Ø§Ù„Ø³Ø§Ø¹Ø©:</span>
                <input type="time" id="edit-election2Time-${club.id}" value="${club.election2Time || '09:00'}">
              </div>
            </td>
            <td>
              <input type="date" id="edit-paymentStart-${club.id}" value="${club.paymentStart || ''}" 
                     onchange="updatePaymentEndDate(${club.id})">
              <div class="time-inputs">
                <span>Ù…Ù†:</span>
                <input type="time" id="edit-paymentStartTime-${club.id}" value="${club.paymentStartTime || '08:00'}">
              </div>
            </td>
            <td>
              <input type="date" id="edit-paymentEnd-${club.id}" value="${club.paymentEnd || ''}">
              <div class="time-inputs">
                <span>Ø¥Ù„Ù‰:</span>
                <input type="time" id="edit-paymentEndTime-${club.id}" value="${club.paymentEndTime || '16:00'}">
              </div>
            </td>
            <td class="action-buttons">
              <button class="action-btn save-btn" data-id="${club.id}">ğŸ’¾</button>
              <button class="action-btn cancel-btn" data-id="${club.id}">âŒ</button>
            </td>
          `;
        } else {
          // ÙˆØ¶Ø¹ Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø¹Ø§Ø¯ÙŠ
          const election1Display = club.election1 ? 
            `${formatDate(club.election1)}<br>${formatTimeTo12H(club.election1Time)}` : '';
          
          const election2Display = club.election2 ? 
            `${formatDate(club.election2)}<br>${formatTimeTo12H(club.election2Time)}` : '';
          
          const paymentStartDisplay = club.paymentStart ? 
            `${formatDate(club.paymentStart)}<br>${formatTimeTo12H(club.paymentStartTime)}` : '';
          
          const paymentEndDisplay = club.paymentEnd ? 
            `${formatDate(club.paymentEnd)}<br>${formatTimeTo12H(club.paymentEndTime)}` : '';
          
          row.innerHTML = `
            <td>${club.name}</td>
            <td>${election1Display}</td>
            <td class="election2-cell">${election2Display}</td>
            <td>${paymentStartDisplay}</td>
            <td>${paymentEndDisplay}</td>
            <td class="action-buttons">
              <button class="action-btn edit-btn" data-id="${club.id}">âœï¸</button>
              <button class="action-btn delete-btn" data-id="${club.id}">ğŸ—‘ï¸</button>
            </td>
          `;
        }
        
        tableBody.appendChild(row);
      });
      
      toggleElection2Visibility();
    }

    // ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙˆØ§Ø±ÙŠØ® Ø§Ù„Ù…Ø­Ø³ÙˆØ¨Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§
    function updateCalculatedDates(id) {
      const election1Input = document.getElementById(`edit-election1-${id}`);
      const election2Input = document.getElementById(`edit-election2-${id}`);
      
      if (election1Input && election1Input.value) {
        const calculatedDates = calculateDatesAutomatically(election1Input.value);
        
        if (election2Input && (!election2Input.value || election2Input.value === calculatedDates.election2)) {
          election2Input.value = calculatedDates.election2;
        }
      }
    }

    // ØªØ­Ø¯ÙŠØ« Ù†Ù‡Ø§ÙŠØ© Ø§Ù„ØªØ³Ø¯ÙŠØ¯ Ø¨Ù†Ø§Ø¡ Ø¹Ù„Ù‰ Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„ØªØ³Ø¯ÙŠØ¯
    function updatePaymentEndDate(id) {
      const paymentStartInput = document.getElementById(`edit-paymentStart-${id}`);
      const paymentEndInput = document.getElementById(`edit-paymentEnd-${id}`);
      
      if (paymentStartInput && paymentStartInput.value) {
        const paymentEnd = calculatePaymentEnd(paymentStartInput.value);
        
        if (paymentEndInput && (!paymentEndInput.value || paymentEndInput.value === paymentEnd)) {
          paymentEndInput.value = paymentEnd;
        }
      }
    }

    // ØªØ­Ø±ÙŠØ± Ù†Ø§Ø¯ÙŠ
    function editClub(id) {
      const club = clubsData.find(c => c.id === id);
      if (!club) return;
      
      // Ø¥Ù„ØºØ§Ø¡ Ø£ÙŠ ØªØ­Ø±ÙŠØ± Ø³Ø§Ø¨Ù‚
      if (currentEditId) {
        cancelEdit(currentEditId);
      }
      
      currentEditId = id;
      renderClubsTable();
    }

    // Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø§Ø¯ÙŠ
    function saveClub(id) {
      const clubIndex = clubsData.findIndex(c => c.id === id);
      if (clubIndex === -1) return;
      
      const election1 = document.getElementById(`edit-election1-${id}`).value;
      const election1Time = document.getElementById(`edit-election1Time-${id}`).value;
      const election2 = document.getElementById(`edit-election2-${id}`).value;
      const election2Time = document.getElementById(`edit-election2Time-${id}`).value;
      const paymentStart = document.getElementById(`edit-paymentStart-${id}`).value;
      const paymentStartTime = document.getElementById(`edit-paymentStartTime-${id}`).value;
      const paymentEnd = document.getElementById(`edit-paymentEnd-${id}`).value;
      const paymentEndTime = document.getElementById(`edit-paymentEndTime-${id}`).value;
      
      if (paymentStart && paymentEnd && new Date(paymentStart) > new Date(paymentEnd)) {
        alert('ØªØ§Ø±ÙŠØ® Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„ØªØ³Ø¯ÙŠØ¯ ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ù‚Ø¨Ù„ ØªØ§Ø±ÙŠØ® Ù†Ù‡Ø§ÙŠØ© Ø§Ù„ØªØ³Ø¯ÙŠØ¯');
        return;
      }
      
      clubsData[clubIndex] = {
        ...clubsData[clubIndex],
        election1,
        election1Time,
        election2,
        election2Time,
        paymentStart,
        paymentStartTime,
        paymentEnd,
        paymentEndTime
      };
      
      saveClubsData();
      currentEditId = null;
      renderClubsTable();
      detectConflicts();
    }

    // Ø¥Ù„ØºØ§Ø¡ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„
    function cancelEdit(id) {
      currentEditId = null;
      renderClubsTable();
    }

    // Ø­Ø°Ù Ù†Ø§Ø¯ÙŠ
    function deleteClub(id) {
      const club = clubsData.find(c => c.id === id);
      if (!club) return;
      
      showModal('Ø­Ø°Ù Ù†Ø§Ø¯ÙŠ', `Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù†Ùƒ ØªØ±ÙŠØ¯ Ø­Ø°Ù "${club.name}"ØŸ`, function(confirmed) {
        if (confirmed) {
          clubsData = clubsData.filter(c => c.id !== id);
          saveClubsData();
          renderClubsTable();
          detectConflicts();
        }
      });
    }

    // Ø§ÙƒØªØ´Ø§Ù Ø§Ù„ØªØ¹Ø§Ø±Ø¶Ø§Øª Ø¨ÙŠÙ† Ù…ÙˆØ§Ø¹ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ®Ø§Ø¨Ø§Øª ÙˆØ§Ù„ØªØ³Ø¯ÙŠØ¯ ÙˆØ¹Ø±Ø¶Ù‡Ø§ ÙÙŠ Ø¬Ø¯ÙˆÙ„
    function detectConflicts() {
      const conflictsContainer = document.getElementById('conflictsContainer');
      conflictsContainer.innerHTML = '';
      
      if (clubsData.length === 0) {
        conflictsContainer.innerHTML = '<div class="no-conflicts">Ù„Ø§ ØªÙˆØ¬Ø¯ ØªØ¹Ø§Ø±Ø¶Ø§Øª - Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ù†Ø¯ÙŠØ© Ù…Ø¶Ø§ÙØ©</div>';
        return;
      }
      
      let allConflicts = [];
      
      // 1. Ø§ÙƒØªØ´Ø§Ù ØªØ¹Ø§Ø±Ø¶Ø§Øª Ø§Ù„Ø§Ù†ØªØ®Ø§Ø¨Ø§Øª Ù…Ø¹ Ø§Ù„Ø§Ù†ØªØ®Ø§Ø¨Ø§Øª (Ø§Ù„Ø§Ù†ØªØ®Ø§Ø¨Ø§Øª Ø§Ù„Ø£ÙˆÙ„Ù‰ ÙÙ‚Ø·)
      const electionConflicts = findElectionConflicts();
      if (electionConflicts.length > 0) {
        allConflicts = allConflicts.concat(electionConflicts);
      }
      
      // 2. Ø§ÙƒØªØ´Ø§Ù ØªØ¹Ø§Ø±Ø¶Ø§Øª Ø§Ù„Ø§Ù†ØªØ®Ø§Ø¨Ø§Øª Ù…Ø¹ ÙØªØ±Ø§Øª Ø§Ù„ØªØ³Ø¯ÙŠØ¯ (Ø§Ù„Ø§Ù†ØªØ®Ø§Ø¨Ø§Øª Ø§Ù„Ø£ÙˆÙ„Ù‰ ÙÙ‚Ø·)
      const electionPaymentConflicts = findElectionPaymentConflicts();
      if (electionPaymentConflicts.length > 0) {
        allConflicts = allConflicts.concat(electionPaymentConflicts);
      }
      
      // 3. Ø§ÙƒØªØ´Ø§Ù ØªØ¹Ø§Ø±Ø¶Ø§Øª ÙØªØ±Ø§Øª Ø§Ù„ØªØ³Ø¯ÙŠØ¯ Ù…Ø¹ Ø¨Ø¹Ø¶Ù‡Ø§
      const paymentConflicts = findPaymentConflicts();
      if (paymentConflicts.length > 0) {
        allConflicts = allConflicts.concat(paymentConflicts);
      }
      
      if (allConflicts.length === 0) {
        conflictsContainer.innerHTML = '<div class="no-conflicts">Ù„Ø§ ØªÙˆØ¬Ø¯ ØªØ¹Ø§Ø±Ø¶Ø§Øª ÙÙŠ Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯</div>';
        return;
      }
      
      // Ø¥Ù†Ø´Ø§Ø¡ Ø¬Ø¯ÙˆÙ„ Ø§Ù„ØªØ¹Ø§Ø±Ø¶Ø§Øª
      const conflictsTable = document.createElement('table');
      conflictsTable.className = 'conflicts-table';
      
      // Ø±Ø£Ø³ Ø§Ù„Ø¬Ø¯ÙˆÙ„
      conflictsTable.innerHTML = `
        <thead>
          <tr>
            <th>Ù†ÙˆØ¹ Ø§Ù„ØªØ¹Ø§Ø±Ø¶</th>
            <th>Ø§Ù„Ø£Ù†Ø¯ÙŠØ© Ø§Ù„Ù…ØªØ¹Ø§Ø±Ø¶Ø©</th>
            <th>ÙØªØ±Ø© Ø§Ù„ØªØ¹Ø§Ø±Ø¶</th>
            <th>Ø£ÙŠØ§Ù… Ø§Ù„ØªØ¯Ø§Ø®Ù„</th>
          </tr>
        </thead>
        <tbody>
          ${allConflicts.map(conflict => {
            let typeClass = '';
            let typeText = '';
            let clubsText = '';
            let dateText = '';
            let icon = '';
            
            if (conflict.type === 'Ø§Ù†ØªØ®Ø§Ø¨Ø§Øª-Ø§Ù†ØªØ®Ø§Ø¨Ø§Øª') {
              typeClass = 'conflict-type-election';
              typeText = 'Ø§Ù†ØªØ®Ø§Ø¨Ø§Øª Ù…Ø¹ Ø§Ù†ØªØ®Ø§Ø¨Ø§Øª';
              clubsText = `${conflict.club1} âš”ï¸ ${conflict.club2}`;
              dateText = `${formatDate(conflict.date1)}`;
              icon = 'ğŸ“…';
            } else if (conflict.type === 'Ø§Ù†ØªØ®Ø§Ø¨Ø§Øª-ØªØ³Ø¯ÙŠØ¯') {
              typeClass = 'conflict-type-mixed';
              typeText = 'Ø§Ù†ØªØ®Ø§Ø¨Ø§Øª Ù…Ø¹ ØªØ³Ø¯ÙŠØ¯';
              clubsText = `${conflict.club1} âš”ï¸ ${conflict.club2}`;
              dateText = `${formatDate(conflict.date)}`;
              icon = 'â°';
            } else if (conflict.type === 'ØªØ³Ø¯ÙŠØ¯-ØªØ³Ø¯ÙŠØ¯') {
              typeClass = 'conflict-type-payment';
              typeText = 'ØªØ³Ø¯ÙŠØ¯ Ù…Ø¹ ØªØ³Ø¯ÙŠØ¯';
              clubsText = `${conflict.club1} âš”ï¸ ${conflict.club2}`;
              dateText = `${formatDate(conflict.startDate1)} - ${formatDate(conflict.endDate1)}`;
              icon = 'ğŸ”„';
            }
            
            return `
              <tr>
                <td><span class="conflict-type ${typeClass}">${icon} ${typeText}</span></td>
                <td>${clubsText}</td>
                <td>${dateText}</td>
                <td><span class="conflict-days">${conflict.overlapDays} Ø£ÙŠØ§Ù…</span></td>
              </tr>
            `;
          }).join('')}
        </tbody>
      `;
      
      conflictsContainer.appendChild(conflictsTable);
      
      // Ø¥Ø¶Ø§ÙØ© Ù…Ù„Ø§Ø­Ø¸Ø© 
      const conflictNote = document.createElement('div');
      conflictNote.className = 'conflict-note';
      conflictNote.innerHTML = `
        <strong>Ù…Ù„Ø§Ø­Ø¸Ø©:</strong> 
        Ø§Ù„ØªØ¹Ø§Ø±Ø¶Ø§Øª ØªØ´Ù…Ù„ ØªØ¯Ø§Ø®Ù„ ØªØ§Ø±ÙŠØ® Ù…ÙˆØ¹Ø¯  Ø§Ù„Ø§Ù†ØªØ®Ø§Ø¨Ø§Øª ÙˆÙ…ÙˆØ¹Ø¯ ÙØªØ±Ø§Øª Ø§Ù„ØªØ³Ø¯ÙŠØ¯ Ø§Ù„Ù…Ø®ØªÙ„ÙØ©. 
        ÙŠØ±Ø¬Ù‰ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯ ÙˆØªØ¹Ø¯ÙŠÙ„Ù‡Ø§ Ù„ØªØ¬Ù†Ø¨ Ø§Ù„ØªØ¹Ø§Ø±Ø¶Ø§Øª.
      `;
      conflictsContainer.appendChild(conflictNote);
      
      // Ø¥Ø¶Ø§ÙØ© Ø¥Ø­ØµØ§Ø¦ÙŠØ© Ø¨Ø¹Ø¯Ø¯ Ø§Ù„ØªØ¹Ø§Ø±Ø¶Ø§Øª
      const totalElement = document.createElement('div');
      totalElement.className = 'conflict-total';
      totalElement.innerHTML = `
        <strong>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØªØ¹Ø§Ø±Ø¶Ø§Øª Ø§Ù„Ù…ÙƒØªØ´ÙØ©: ${allConflicts.length}</strong>
      `;
      conflictsContainer.appendChild(totalElement);
    }

    // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† ØªØ¹Ø§Ø±Ø¶Ø§Øª Ù…ÙˆØ§Ø¹ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ®Ø§Ø¨Ø§Øª Ù…Ø¹ Ø§Ù„Ø§Ù†ØªØ®Ø§Ø¨Ø§Øª (Ø§Ù„Ø§Ù†ØªØ®Ø§Ø¨Ø§Øª Ø§Ù„Ø£ÙˆÙ„Ù‰ ÙÙ‚Ø·)
    function findElectionConflicts() {
      const conflicts = [];
      const dateMap = {};
      
      // ØªØ¬Ù…ÙŠØ¹ Ø§Ù„Ø§Ù†ØªØ®Ø§Ø¨Ø§Øª Ø­Ø³Ø¨ Ø§Ù„ØªØ§Ø±ÙŠØ® (Ø§Ù„Ø§Ù†ØªØ®Ø§Ø¨Ø§Øª Ø§Ù„Ø£ÙˆÙ„Ù‰ ÙÙ‚Ø·)
      clubsData.forEach(club => {
        if (club.election1) {
          if (!dateMap[club.election1]) dateMap[club.election1] = [];
          dateMap[club.election1].push({club: club.name, type: 'election1'});
        }
        // ØªÙ… Ø¥Ø²Ø§Ù„Ø© Ø¬Ù…Ø¹ Ø§Ù„Ø§Ù†ØªØ®Ø§Ø¨Ø§Øª Ø§Ù„Ø«Ø§Ù†ÙŠØ©
      });
      
      // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„ØªÙˆØ§Ø±ÙŠØ® Ø§Ù„ØªÙŠ Ø¨Ù‡Ø§ Ø£ÙƒØ«Ø± Ù…Ù† Ù†Ø§Ø¯ÙŠ
      for (const [date, clubs] of Object.entries(dateMap)) {
        if (clubs.length > 1) {
          // Ø¥Ù†Ø´Ø§Ø¡ ØªØ¹Ø§Ø±Ø¶Ø§Øª Ø¨ÙŠÙ† ÙƒÙ„ Ù†Ø§Ø¯ÙŠÙŠÙ† ÙÙŠ Ù†ÙØ³ Ø§Ù„ØªØ§Ø±ÙŠØ®
          for (let i = 0; i < clubs.length; i++) {
            for (let j = i + 1; j < clubs.length; j++) {
              conflicts.push({
                type: 'Ø§Ù†ØªØ®Ø§Ø¨Ø§Øª-Ø§Ù†ØªØ®Ø§Ø¨Ø§Øª',
                club1: clubs[i].club,
                date1: date,
                club2: clubs[j].club,
                date2: date,
                overlapDays: 1
              });
            }
          }
        }
      }
      
      return conflicts;
    }

    // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† ØªØ¹Ø§Ø±Ø¶Ø§Øª Ø§Ù„Ø§Ù†ØªØ®Ø§Ø¨Ø§Øª Ù…Ø¹ ÙØªØ±Ø§Øª Ø§Ù„ØªØ³Ø¯ÙŠØ¯ (Ø§Ù„Ø§Ù†ØªØ®Ø§Ø¨Ø§Øª Ø§Ù„Ø£ÙˆÙ„Ù‰ ÙÙ‚Ø·)
    function findElectionPaymentConflicts() {
      const conflicts = [];
      
      for (let i = 0; i < clubsData.length; i++) {
        const club1 = clubsData[i];
        
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªØ¹Ø§Ø±Ø¶ Ù…ÙˆØ¹Ø¯ Ø§Ù„Ø§Ù†ØªØ®Ø§Ø¨Ø§Øª Ø§Ù„Ø£ÙˆÙ„ Ù…Ø¹ ÙØªØ±Ø§Øª Ø§Ù„ØªØ³Ø¯ÙŠØ¯ ÙÙ‚Ø·
        if (club1.election1) {
          for (let j = 0; j < clubsData.length; j++) {
            const club2 = clubsData[j];
            if (club2.paymentStart && club2.paymentEnd) {
              const electionDate = new Date(club1.election1);
              const paymentStart = new Date(club2.paymentStart);
              const paymentEnd = new Date(club2.paymentEnd);
              
              // Ø§Ù„ØªØ­Ù‚Ù‚ Ø¥Ø°Ø§ ÙƒØ§Ù† ØªØ§Ø±ÙŠØ® Ù…ÙˆØ¹Ø¯ Ø§Ù„Ø§Ù†ØªØ®Ø§Ø¨Ø§Øª ÙŠÙ‚Ø¹ Ø¶Ù…Ù† ÙØªØ±Ø© Ø§Ù„ØªØ³Ø¯ÙŠØ¯
              if (electionDate >= paymentStart && electionDate <= paymentEnd) {
                const overlapDays = 1;
                
                conflicts.push({
                  type: 'Ø§Ù†ØªØ®Ø§Ø¨Ø§Øª-ØªØ³Ø¯ÙŠØ¯',
                  club1: club1.name,
                  date: club1.election1,
                  club2: club2.name,
                  paymentStart: club2.paymentStart,
                  paymentEnd: club2.paymentEnd,
                  overlapDays: overlapDays
                });
              }
            }
          }
        }
        
        // ØªÙ… Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªØ¹Ø§Ø±Ø¶ Ù…ÙˆØ¹Ø¯ Ø§Ù„Ø§Ù†ØªØ®Ø§Ø¨Ø§Øª Ø§Ù„Ø«Ø§Ù†ÙŠ Ù…Ø¹ ÙØªØ±Ø§Øª Ø§Ù„ØªØ³Ø¯ÙŠØ¯
      }
      
      return conflicts;
    }

    // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† ØªØ¹Ø§Ø±Ø¶Ø§Øª ÙØªØ±Ø§Øª Ø§Ù„ØªØ³Ø¯ÙŠØ¯ Ù…Ø¹ Ø¨Ø¹Ø¶Ù‡Ø§
    function findPaymentConflicts() {
      const conflicts = [];
      
      for (let i = 0; i < clubsData.length; i++) {
        const club1 = clubsData[i];
        
        if (club1.paymentStart && club1.paymentEnd) {
          for (let j = i + 1; j < clubsData.length; j++) {
            const club2 = clubsData[j];
            
            if (club2.paymentStart && club2.paymentEnd) {
              const overlapDays = calculateOverlapDays(
                club1.paymentStart, club1.paymentEnd,
                club2.paymentStart, club2.paymentEnd
              );
              
              if (overlapDays > 0) {
                conflicts.push({
                  type: 'ØªØ³Ø¯ÙŠØ¯-ØªØ³Ø¯ÙŠØ¯',
                  club1: club1.name,
                  startDate1: club1.paymentStart,
                  endDate1: club1.paymentEnd,
                  club2: club2.name,
                  startDate2: club2.paymentStart,
                  endDate2: club2.paymentEnd,
                  overlapDays: overlapDays
                });
              }
            }
          }
        }
      }
      
      return conflicts;
    }

    // Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ localStorage
    function saveClubsData() {
      localStorage.setItem('electionClubs', JSON.stringify(clubsData));
      localStorage.setItem('lastBackupDate', new Date().toISOString());
      updateBackupStats();
    }

    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† localStorage
    function loadClubsData() {
      const savedData = localStorage.getItem('electionClubs');
      if (savedData) {
        clubsData = JSON.parse(savedData);
        
        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ù„Ù„ÙˆÙ‚Øª Ø¥Ø°Ø§ Ù„Ù… ØªÙƒÙ† Ù…ÙˆØ¬ÙˆØ¯Ø©
        clubsData.forEach(club => {
          if (!club.election1Time) club.election1Time = '09:00';
          if (!club.election2Time) club.election2Time = '09:00';
          if (!club.paymentStartTime) club.paymentStartTime = '08:00';
          if (!club.paymentEndTime) club.paymentEndTime = '16:00';
        });
      }
    }

    // ØªØµØ¯ÙŠØ± Ø¥Ù„Ù‰ Excel
    function exportExcel() {
      if (clubsData.length === 0) {
        alert('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„ØªØµØ¯ÙŠØ±');
        return;
      }
      
      // ØªØ­Ø¶ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„ØªØµØ¯ÙŠØ±
      const dataToExport = clubsData.map(club => ({
        'Ø§Ø³Ù… Ø§Ù„Ù†Ø§Ø¯ÙŠ': club.name,
        'Ù…ÙˆØ¹Ø¯ Ø§Ù„Ø§Ù†ØªØ®Ø§Ø¨Ø§Øª Ø§Ù„Ø£ÙˆÙ„': formatDate(club.election1),
        'ÙˆÙ‚Øª Ø§Ù„Ø§Ù†ØªØ®Ø§Ø¨Ø§Øª Ø§Ù„Ø£ÙˆÙ„': formatTimeTo12H(club.election1Time),
        'Ù…ÙˆØ¹Ø¯ Ø§Ù„Ø§Ù†ØªØ®Ø§Ø¨Ø§Øª Ø§Ù„Ø«Ø§Ù†ÙŠ': formatDate(club.election2),
        'ÙˆÙ‚Øª Ø§Ù„Ø§Ù†ØªØ®Ø§Ø¨Ø§Øª Ø§Ù„Ø«Ø§Ù†ÙŠ': formatTimeTo12H(club.election2Time),
        'Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„ØªØ³Ø¯ÙŠØ¯': formatDate(club.paymentStart),
        'ÙˆÙ‚Øª Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„ØªØ³Ø¯ÙŠØ¯': formatTimeTo12H(club.paymentStartTime),
        'Ù†Ù‡Ø§ÙŠØ© Ø§Ù„ØªØ³Ø¯ÙŠØ¯': formatDate(club.paymentEnd),
        'ÙˆÙ‚Øª Ù†Ù‡Ø§ÙŠØ© Ø§Ù„ØªØ³Ø¯ÙŠØ¯': formatTimeTo12H(club.paymentEndTime)
      }));
      
      // Ø¥Ù†Ø´Ø§Ø¡ ÙˆØ±Ù‚Ø© Ø¹Ù…Ù„
      const ws = XLSX.utils.json_to_sheet(dataToExport);
      const wb = XLSX.utils.book_new();
      XLSX.utils.book_append_sheet(wb, ws, 'Ù…ÙˆØ§Ø¹ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ®Ø§Ø¨Ø§Øª');
      
      // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù
      XLSX.writeFile(wb, 'Ù…ÙˆØ§Ø¹ÙŠØ¯_Ø§Ù†ØªØ®Ø§Ø¨Ø§Øª_Ø§Ù„Ø£Ù†Ø¯ÙŠØ©.xlsx');
    }

    // Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©
    function exportBackup() {
      if (clubsData.length === 0) {
        alert('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©');
        return;
      }
      
      const backupData = {
        clubs: clubsData,
        exportDate: new Date().toISOString()
      };
      
      const dataStr = JSON.stringify(backupData);
      const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
      
      const exportFileDefaultName = `election_clubs_backup_${new Date().toISOString().slice(0,10)}.json`;
      
      const linkElement = document.createElement('a');
      linkElement.setAttribute('href', dataUri);
      linkElement.setAttribute('download', exportFileDefaultName);
      linkElement.click();
      
      // ØªØ­Ø¯ÙŠØ« Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ
      updateBackupStats();
      
      alert('ØªÙ… ØªØµØ¯ÙŠØ± Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­');
    }

    // Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©
    function importBackup() {
      const input = document.createElement('input');
      input.type = 'file';
      input.accept = '.json';
      
      input.onchange = e => {
        const file = e.target.files[0];
        if (!file) return;
        
        const reader = new FileReader();
        reader.onload = function(event) {
          try {
            const backupData = JSON.parse(event.target.result);
            
            if (!backupData.clubs || !Array.isArray(backupData.clubs)) {
              throw new Error('Ù…Ù„Ù Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© ØºÙŠØ± ØµØ§Ù„Ø­');
            }
            
            showModal('Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©', 'Ù‡Ù„ ØªØ±ÙŠØ¯ Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ø¨Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªÙˆØ±Ø¯Ø©ØŸ Ø³ÙŠØªÙ… ÙÙ‚Ø¯Ø§Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©.', function(confirmed) {
              if (confirmed) {
                clubsData = backupData.clubs;
                saveClubsData();
                renderClubsTable();
                detectConflicts();
                updateBackupStats();
                alert('ØªÙ… Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­');
              }
            });
          } catch (error) {
            alert('ÙØ´Ù„ ÙÙŠ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©: ' + error.message);
          }
        };
        
        reader.readAsText(file);
      };
      
      input.click();
    }

    // ØªØ­Ø¯ÙŠØ« Ø¥Ø­ØµØ§Ø¡Ø§Øª Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ
    function updateBackupStats() {
      document.getElementById('clubsCount').textContent = clubsData.length;
      
      // Ø­Ø³Ø§Ø¨ Ø­Ø¬Ù… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
      const dataSize = JSON.stringify(clubsData).length;
      document.getElementById('dataSize').textContent = Math.round(dataSize / 1024) + ' KB';
      
      // ØªØ­Ø¯ÙŠØ« ØªØ§Ø±ÙŠØ® Ø¢Ø®Ø± Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©
      const lastBackup = localStorage.getItem('lastBackupDate');
      document.getElementById('lastBackup').textContent = lastBackup ? new Date(lastBackup).toLocaleDateString('ar-EG') : 'Ù„Ø§ ÙŠÙˆØ¬Ø¯';
    }

    // Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
    function clearAllData() {
      if (clubsData.length === 0) {
        alert('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ù…Ø³Ø­');
        return;
      }
      
      showModal('Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', 'Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù†Ùƒ ØªØ±ÙŠØ¯ Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù† Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡.', function(confirmed) {
        if (confirmed) {
          clubsData = [];
          localStorage.removeItem('electionClubs');
          localStorage.removeItem('lastBackupDate');
          renderClubsTable();
          detectConflicts();
          updateBackupStats();
          alert('ØªÙ… Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­');
        }
      });
    }

    // Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©
    function showModal(title, message, callback) {
      document.getElementById('modalTitle').textContent = title;
      document.getElementById('modalMessage').textContent = message;
      document.getElementById('confirmationModal').style.display = 'block';
      modalCallback = callback;
    }

    function closeModal(confirmed) {
      document.getElementById('confirmationModal').style.display = 'none';
      if (modalCallback) {
        modalCallback(confirmed);
        modalCallback = null;
      }
    }
  </script>
</body>
</html>
